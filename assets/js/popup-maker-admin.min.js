var PUMChosenFields;!function(e){"use strict";PUMChosenFields={init:function(){e(".pum-chosen select").filter(":not(.initialized)").addClass("initialized").chosen({allow_single_deselect:!0,width:"100%"}).next().css({})}},e(document).on("pum_init",PUMChosenFields.init)}(jQuery);var PUMColorPickers;!function(e){"use strict";PUMColorPickers={init:function(){e(".color-picker").filter(":not(.initialized)").addClass("initialized").wpColorPicker({change:function(t){var o=e(t.currentTarget);o.hasClass("background-color")&&o.parents("table").find(".background-opacity").show(),PUMUtils.throttle(function(){PopMakeAdmin.update_theme()},50)},clear:function(t){var o=e(t.currentTarget).prev();o.hasClass("background-color")&&o.parents("table").find(".background-opacity").hide(),PopMakeAdmin.update_theme()}})}},e(document).on("pum_init",PUMColorPickers.init)}(jQuery);var PUMCookies;!function(e){"use strict";var t=pum_admin.I10n,o=pum_admin.defaults;PUMCookies={getLabel:function(e){return t.labels.cookies[e].name},getSettingsDesc:function(e,o){var i=_.template(t.labels.cookies[e].settings_column);return o.I10n=t,i(o)},renumber:function(){e("#pum_popup_cookies_list tbody tr").each(function(){var t=e(this),o=t.parent().children().index(t),i=t.data("index");t.data("index",o),t.find("[name]").each(function(){var e="["+o+"]";this.name=this.name.replace("["+i+"]",e).replace("[]",e)})})},refreshDescriptions:function(){e("#pum_popup_cookies_list tbody tr").each(function(){var t=e(this),o=t.find(".popup_cookies_field_event").val(),i=JSON.parse(t.find(".popup_cookies_field_settings:first").val());t.find("td.settings-column").html(PUMCookies.getSettingsDesc(o,i))})},initEditForm:function(){PUMCookies.updateSessionsCheckbox()},updateSessionsCheckbox:function(){var t=e(".cookie-editor .pum-form"),o=t.find('.field.checkbox.session input[type="checkbox"]').is(":checked"),i=t.find(".field").filter(".time");o?i.hide():i.show()},resetCookieKey:function(){var t=e(this),o=(new Date).getTime().toString(16);t.parents(".pum-form").find(".field.text.name").data("cookiekey",o),t.siblings('input[type="text"]:first').val(o)}},e(document).on("click",".field.cookiekey button.reset",PUMCookies.resetCookieKey).on("click",".cookie-editor .pum-form .field.checkbox.session",PUMCookies.updateSessionsCheckbox).on("click","#pum_popup_cookies .add-new",function(){var t=_.template(e("script#pum_cookie_add_event_templ").html());PUMModals.reload("#pum_cookie_add_event_modal",t())}).on("click","#pum_popup_cookies_list .edit",function(o){var i=e(this),n=i.parents("tr:first"),r=n.find(".popup_cookies_field_event").val(),a="#pum_cookie_settings_"+r,s=_.template(e("script"+a+"_templ").html()),p={index:n.parent().children().index(n),event:r,cookie_settings:JSON.parse(n.find(".popup_cookies_field_settings:first").val())};o.preventDefault(),p.save_button_text=t.save,s.length||alert("Something went wrong. Please refresh and try again."),PUMModals.reload(a,s(p)),PUMCookies.initEditForm()}).on("click","#pum_popup_cookies_list .remove",function(o){var i=e(this),n=i.parents("tr:first");o.preventDefault(),window.confirm(t.confirm_delete_cookie)&&(n.remove(),PUMCookies.renumber())}).on("submit","#pum_cookie_add_event_modal .pum-form",function(i){var n=e("#popup_cookie_add_event").val(),r="#pum_cookie_settings_"+n,a=_.template(e("script"+r+"_templ").html()),s={};i.preventDefault(),s.cookie_settings=void 0!==o.cookies[n]?o.cookies[n]:{},s.cookie_settings.name="pum-"+e("#post_ID").val(),s.save_button_text=t.add,s.index=null,a.length||alert("Something went wrong. Please refresh and try again."),PUMModals.reload(r,a(s)),PUMCookies.initEditForm(r)}).on("submit",".cookie-editor .pum-form",function(o){var i,n,r,a=e(this),s=(a.find("input.event").val(),a.serializeObject()),p=parseInt(s.index),l=p>=0?e("#pum_popup_cookies_list tbody tr").eq(p):null,c=_.template(e("script#pum_cookie_row_templ").html());o.preventDefault(),p>=0||(s.index=e("#pum_popup_cookies_list tbody tr").length),s.I10n=t,i=c(s),l?l.replaceWith(i):e("#pum_popup_cookies_list tbody").append(i),PUMModals.closeAll(),PUMCookies.renumber(),PUMTriggers.new_cookie>=0&&(n=e("#pum_popup_triggers_list tbody tr").eq(PUMTriggers.new_cookie).find(".popup_triggers_field_settings:first"),r=JSON.parse(n.val()),r.cookie.name[r.cookie.name.indexOf("add_new")]=s.cookie_settings.name,n.val(JSON.stringify(r)),PUMTriggers.new_cookie=-1,PUMTriggers.refreshDescriptions())}).ready(PUMCookies.refreshDescriptions)}(jQuery);var PUMMarketing;!function(e){"use strict";PUMMarketing={init:function(){e('#menu-posts-popup ul li a[href="edit.php?post_type=popup&page=extensions"]').css({color:"#9aba27"})}},e(document).ready(PUMMarketing.init)}(jQuery);var PUMModals;!function(e){"use strict";var t=e("html"),o=e(document);PUMModals={closeAll:function(){e(".pum-modal-background").hide(),e("html").css({overflow:"visible",width:"auto"})},show:function(i){PUMModals.closeAll(),t.data("origwidth",t.innerWidth()).css({overflow:"hidden",width:t.innerWidth()}),e(i).show(),o.trigger("pum_init")},remove:function(t){e(t).remove()},replace:function(t,o){PUMModals.remove(t),e("body").append(o)},reload:function(e,t){PUMModals.replace(e,t),PUMModals.show(e)}},e(document).on("click",".pum-modal-background, .pum-modal-wrap .cancel, .pum-modal-wrap .pum-modal-close",function(t){var o=e(t.target);(o.hasClass("pum-modal-background")||o.hasClass("cancel")||o.hasClass("pum-modal-close")||o.hasClass("submitdelete"))&&(PUMModals.closeAll(),t.preventDefault(),t.stopPropagation())})}(jQuery);var PUMRangeSLiders;!function(e){"use strict";PUMRangeSLiders={init:function(){var t,o,i,n,r,a=e('<input type="range"/>'),s=e('<button type="button" class="popmake-range-plus">+</button>'),p=e('<button type="button" class="popmake-range-minus">-</button>');e(".popmake-range-manual").filter(":not(.initialized)").each(function(){var l=e(this).addClass("initialized"),c=l.data("force-minmax"),u=parseInt(l.prop("min"),0),d=parseInt(l.prop("max"),0),_=parseInt(l.prop("step"),0),m=parseInt(l.val(),0);i=a.clone(),n=s.clone(),r=p.clone(),c&&m>d&&(m=d,l.val(m)),i.prop({min:u||0,max:c||d&&d>m?d:1.5*m,step:_||1.5*m/100,value:m}).on("change input",function(){l.trigger("input")}),l.next().after(r,n),l.before(i),t=document.createElement("input"),t.setAttribute("type","range"),"text"===t.type&&e("input[type=range]").each(function(t,n){o=e(n),i=e("<div />").slider({min:parseInt(o.attr("min"),10)||0,max:parseInt(o.attr("max"),10)||100,value:parseInt(o.attr("value"),10)||0,step:parseInt(o.attr("step"),10)||1,slide:function(t,o){e(this).prev("input").val(o.value)}}),o.after(i).hide()})})}},e(document).on("pum_init",PUMRangeSLiders.init).on("input",'input[type="range"]',function(){var t=e(this);t.siblings(".popmake-range-manual").val(t.val())}).on("click",".popmake-range-manual",function(){var t=e(this);t.prop("readonly",!1)}).on("focusout",".popmake-range-manual",function(){var t=e(this);t.prop("readonly",!0)}).on("change",".popmake-range-manual",function(){var t=e(this),o=parseInt(t.prop("max"),0),i=parseInt(t.prop("step"),0),n=t.data("force-minmax"),r=parseInt(t.val(),0),a=t.prev();n&&r>o&&(r=o,t.val(r)),a.prop({max:n||o&&o>r?o:1.5*r,step:i||1.5*r/100,value:r})}).on("click",".popmake-range-plus",function(t){var o=e(this).siblings(".popmake-range-manual"),i=parseInt(o.prop("step"),0),n=parseInt(o.val(),0),r=n+i,a=o.prev();t.preventDefault(),o.val(r).trigger("input"),a.val(r)}).on("click",".popmake-range-minus",function(t){var o=e(this).siblings(".popmake-range-manual"),i=parseInt(o.prop("step"),0),n=parseInt(o.val(),0),r=n-i,a=o.prev();t.preventDefault(),o.val(r).trigger("input"),a.val(r)})}(jQuery),function(){function e(e,t){return-1!==i.inArray(t,e)}function t(e,o,i){var n=o[0];o.length>1?(e[n]||(e[n]=o[1]?{}:[]),t(e[n],o.slice(1),i)):(n||(n=e.length),e[n]=i)}var o=this,i=o.jQuery||o.Zepto||o.ender,n="color,date,datetime,datetime-local,email,hidden,month,number,password,range,search,tel,text,time,url,week".split(","),r="select,textarea".split(","),a=/\[([^\]]*)\]/g;i.fn.serializeObject=function(o){o||(o={});var s={},p=i.extend(!0,{include:[],exclude:[],includeByClass:""},o);return this.find(":input").each(function(){var o;!this.name||this.disabled||e(p.exclude,this.name)||p.include.length&&!e(p.include,this.name)||-1===this.className.indexOf(p.includeByClass)||(o=this.name.replace(a,"[$1").split("["),o[0]&&(this.checked||e(n,this.type)||e(r,this.nodeName.toLowerCase()))&&("checkbox"===this.type&&o.push(""),t(s,o,i(this).val())))}),s}}.call(this);var PUMTabs;!function(e){"use strict";PUMTabs={init:function(){e(".pum-tabs-container").filter(":not(.initialized)").each(function(){var t=e(this),o=t.find(".tab:first");t.find(".active").removeClass("active"),o.addClass("active"),e(o.find("a").attr("href")).addClass("active")})}},e(document).on("pum_init",PUMTabs.init).on("click",".pum-tabs-container .tab",function(t){var o=e(this),i=o.parents(".pum-tabs-container:first"),n=o.find("a").attr("href");i.find(".active").removeClass("active"),o.addClass("active"),e(n).addClass("active"),t.preventDefault()})}(jQuery);var PUMTriggers;!function(e){"use strict";var t=pum_admin.I10n,o=pum_admin.defaults;PUMTriggers={new_cookie:null,getLabel:function(e){return t.labels.triggers[e].name},getSettingsDesc:function(e,o){var i=_.template(t.labels.triggers[e].settings_column);return o.I10n=t,i(o)},renumber:function(){e("#pum_popup_triggers_list tbody tr").each(function(){var t=e(this),o=t.parent().children().index(t),i=t.data("index");t.data("index",o),t.find("input").each(function(){var e="["+o+"]";this.name=this.name.replace("["+i+"]",e).replace("[]",e)})})},refreshDescriptions:function(){e("#pum_popup_triggers_list tbody tr").each(function(){var t=e(this),o=t.find(".popup_triggers_field_type").val(),i=JSON.parse(t.find(".popup_triggers_field_settings:first").val());t.find("td.settings-column").html(PUMTriggers.getSettingsDesc(o,i)),"array"==typeof i.cookie.name?t.find("td.cookie-column code").text(i.cookie.name.join(", ")):t.find("td.cookie-column code").text(i.cookie.name)})},initEditForm:function(t){var o=e(".trigger-editor .pum-form"),i=e("#name",o),n=t.trigger_settings;e("#pum_popup_cookies_list tbody tr").each(function(){var t=JSON.parse(e(this).find(".popup_cookies_field_settings:first").val());i.find('option[value="'+t.name+'"]').length||e('<option value="'+t.name+'">'+t.name+"</option>").appendTo(i)}),i.val(n.cookie.name),i.trigger("chosen:updated")}},PUMTriggers.refreshDescriptions(),e(document).on("click","#pum_popup_triggers .add-new",function(){var t=_.template(e("script#pum_trigger_add_type_templ").html());PUMModals.reload("#pum_trigger_add_type_modal",t())}).on("click","#pum_popup_triggers_list .edit",function(o){var i=e(this),n=i.parents("tr:first"),r=n.find(".popup_triggers_field_type").val(),a="#pum_trigger_settings_"+r,s=_.template(e("script"+a+"_templ").html()),p={index:n.parent().children().index(n),type:r,trigger_settings:JSON.parse(n.find(".popup_triggers_field_settings:first").val())};o.preventDefault(),p.save_button_text=t.save,s.length||alert("Something went wrong. Please refresh and try again."),PUMModals.reload(a,s(p)),PUMTriggers.initEditForm(p)}).on("click","#pum_popup_triggers_list .remove",function(o){var i=e(this),n=i.parents("tr:first");o.preventDefault(),window.confirm(t.confirm_delete_trigger)&&(n.remove(),PUMTriggers.renumber())}).on("submit","#pum_trigger_add_type_modal .pum-form",function(i){var n=e("#popup_trigger_add_type").val(),r="#pum_trigger_settings_"+n,a=_.template(e("script"+r+"_templ").html()),s={};i.preventDefault(),s.trigger_settings=void 0!==o.triggers[n]?o.triggers[n]:{},s.save_button_text=t.add,s.index=null,a.length||alert("Something went wrong. Please refresh and try again."),PUMModals.reload(r,a(s)),PUMTriggers.initEditForm(s)}).on("submit",".trigger-editor .pum-form",function(o){var i,n=e(this),r=(n.find("input.type").val(),n.serializeObject()),a=parseInt(r.index),s=a>=0?e("#pum_popup_triggers_list tbody tr").eq(a):null,p=_.template(e("script#pum_trigger_row_templ").html());o.preventDefault(),a>=0||(r.index=e("#pum_popup_triggers_list tbody tr").length),r.I10n=t,i=p(r),s?s.replaceWith(i):e("#pum_popup_triggers_list tbody").append(i),PUMModals.closeAll(),PUMTriggers.renumber(),null!==r.trigger_settings.cookie.name&&r.trigger_settings.cookie.name.indexOf("add_new")>=0&&(PUMTriggers.new_cookie=r.index,e("#pum_popup_cookie_fields button.add-new").trigger("click"))}).ready(PUMTriggers.refreshDescriptions)}(jQuery);var PUMUtils;!function(e){"use strict";PUMUtils={convert_meta_to_object:function(e){var t,o,i,n={};for(i in e)e.hasOwnProperty(i)&&(t=i.split(/_(.+)?/)[0],o=i.split(/_(.+)?/)[1],void 0===n[t]&&(n[t]={}),n[t][o]=e[i]);return n},serialize_form:function(t){var o={};return e("[name]",t).each(function(){var t,i,n=e(this).attr("name"),r=e(this).val(),a=n.split("["),s=o,p=a.length;for(t=0;p>t;t+=1)i=a[t].replace("]",""),s[i]||(s[i]={}),t!==a.length-1?s=s[i]:t===a.length-1&&(s[i]=r)}),o},convert_hex:function(e,t){e=e.replace("#","");var o=parseInt(e.substring(0,2),16),i=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16),r="rgba("+o+","+i+","+n+","+t/100+")";return r},debounce:function(e,t){var o;return function(){var i=this,n=arguments;window.clearTimeout(o),o=window.setTimeout(function(){e.apply(i,n)},t)}},throttle:function(e,t){var o=!1,i=function(){o=!1};return function(){o||(e(),window.setTimeout(i,t),o=!0)}}},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)}}(jQuery);var PopMakeAdmin,PUM_Admin;!function(e){"use strict";var t=e(document);pum_admin.I10n,pum_admin.defaults;PUM_Admin={},PopMakeAdmin={init:function(){jQuery("body.post-type-popup form#post").length&&(PopMakeAdmin.initialize_popup_page(),PopMakeAdmin.attachQuickSearchListeners(),PopMakeAdmin.attachTabsPanelListeners()),jQuery("body.post-type-popup_theme form#post").length&&PopMakeAdmin.initialize_theme_page(),jQuery(document).keydown(function(e){return"115"!==e.which&&"83"!==e.which||!e.ctrlKey&&!e.metaKey?!0:(e.preventDefault(),jQuery("body.post-type-popup form#post, body.post-type-popup_theme form#post").submit(),!1)})},attachTabsPanelListeners:function(){jQuery("#poststuff").bind("click",function(e){var t,o,i,n,r,a,s,p,l,c,u,d,_,m,h=jQuery(e.target);if(h.hasClass("nav-tab-link"))o=h.data("type"),i=h.parents(".posttypediv, .taxonomydiv").first(),jQuery("input",i).removeAttr("checked"),jQuery(".tabs-panel-active",i).removeClass("tabs-panel-active").addClass("tabs-panel-inactive"),jQuery("#"+o,i).removeClass("tabs-panel-inactive").addClass("tabs-panel-active"),jQuery(".tabs",i).removeClass("tabs"),h.parent().addClass("tabs"),jQuery(".quick-search",i).focus(),e.preventDefault();else if(h.hasClass("select-all"))t=/#(.*)$/.exec(e.target.href),t&&t[1]&&(n=jQuery("#"+t[1]+" .tabs-panel-active .menu-item-title input"),n.length===n.filter(":checked").length?n.removeAttr("checked"):n.prop("checked",!0));else if(h.hasClass("submit-add-to-menu")){for(r=h.parents(".options"),a=jQuery('.tabs-panel-active input[type="checkbox"]:checked',r),s=jQuery("textarea",r),p=jQuery(".tagchecklist",r),l=s.val().split(","),c=0;c<l.length;c+=1)l[c]=parseInt(l[c],10);a.each(function(){u=jQuery(this),d=parseInt(u.val(),10),_=u.parent("label").siblings(".menu-item-title").val(),-1===jQuery.inArray(d,l)&&l.push(d),p.append('<span><a class="ntdelbutton" data-id="'+d+'">X</a> '+_+"</span>")}),s.text(l.join(",")),e.preventDefault()}else h.hasClass("ntdelbutton")&&(u=h,m=parseInt(u.data("id"),10),r=h.parents(".options"),s=jQuery("textarea",r),p=jQuery(".tagchecklist",r),l=s.val().split(","),l=jQuery.grep(l,function(e){return parseInt(e,10)!==parseInt(m,10)}),u.parent("span").remove(),s.text(l.join(",")))})},attachQuickSearchListeners:function(){var e;jQuery(".quick-search").keypress(function(t){var o=jQuery(this);return 13===t.which?(PopMakeAdmin.updateQuickSearchResults(o),!1):(e&&clearTimeout(e),void(e=setTimeout(function(){PopMakeAdmin.updateQuickSearchResults(o)},400)))}).attr("autocomplete","off")},updateQuickSearchResults:function(e){var t,o,i=2,n=e.val();n.length<i||(t=e.parents(".tabs-panel"),o={action:"menu-quick-search","response-format":"markup",menu:null,"menu-settings-column-nonce":jQuery("#menu-settings-column-nonce").val(),q:n,type:e.attr("name")},jQuery(".spinner",t).show(),jQuery.post(ajaxurl,o,function(e){PopMakeAdmin.processQuickSearchQueryResponse(e,o,t)}))},processQuickSearchQueryResponse:function(e,t,o){var i,n,r,a=jQuery("form#post"),s={},p=/menu-item[(\[\^]\]*/,l=jQuery("<div>").html(e).find("li");return l.length?(l.each(function(){if(r=jQuery(this),i=p.exec(r.html()),i&&i[1]){for(n=i[1];a.elements["menu-item["+n+"][menu-item-type]"]||s[n];)n-=1;s[n]=!0,n!==i[1]&&r.html(r.html().replace(new RegExp("menu-item\\["+i[1]+"\\]","g"),"menu-item["+n+"]"))}}),jQuery(".categorychecklist",o).html(l),jQuery(".spinner",o).hide(),void jQuery('[name^="menu-item"]').removeAttr("name")):(jQuery(".categorychecklist",o).html("<li><p>noResultsFound</p></li>"),void jQuery(".spinner",o).hide())},initialize_popup_page:function(){var e=function(e){var t,o,i=e.siblings(".options");e.is(":checked")?(i.show(),"popup_targeting_condition_on_entire_site"===e.attr("id")?(t=e.parents("#popmake_popup_targeting_condition_fields").find('[id^="targeting_condition-exclude_on_"]'),o=e.parents(".targeting_condition").siblings(".targeting_condition"),o.hide(),jQuery("> *",o).prop("disabled",!0),t.show(),jQuery("> *",t).prop("disabled",!1)):jQuery("*",i).prop("disabled",!1)):(i.hide(),"popup_targeting_condition_on_entire_site"===e.attr("id")?(t=e.parents("#popmake_popup_targeting_condition_fields").find('[id^="targeting_condition-exclude_on_"]'),o=e.parents(".targeting_condition").siblings(".targeting_condition"),o.show(),jQuery("> *",o).prop("disabled",!1),t.hide(),jQuery("> *",t).prop("disabled",!0)):jQuery("*",i).prop("disabled",!0))},t=function(e){var t=e.parents(".options").find('input[type="checkbox"]:eq(0)'),o=t.attr("name").indexOf("exclude")>=0,i=o?t.attr("name").replace("popup_targeting_condition_exclude_on_specific_",""):t.attr("name").replace("popup_targeting_condition_on_specific_",""),n=o?jQuery("#exclude_on_specific_"+i):jQuery("#on_specific_"+i);e.is(":checked")&&("true"===e.val()?(t.prop("checked",!0),n.show(),jQuery("*",n).prop("disabled",!1)):""===e.val()&&(t.prop("checked",!1),n.hide(),jQuery("*",n).prop("disabled",!0)))},o=function(){"custom"===jQuery("#popup_display_size").val()?(jQuery(".custom-size-only").show(),jQuery(".responsive-size-only").hide(),jQuery("#popup_display_custom_height_auto").is(":checked")?jQuery(".custom-size-height-only").hide():jQuery(".custom-size-height-only").show()):(jQuery(".custom-size-only").hide(),"auto"!==jQuery("#popup_display_size").val()?(jQuery(".responsive-size-only").show(),jQuery("#popup_display_custom_height_auto").prop("checked",!1)):jQuery(".responsive-size-only").hide())},i=function(){jQuery(".animation-speed, .animation-origin").hide(),"fade"===jQuery("#popup_display_animation_type").val()?jQuery(".animation-speed").show():"none"!==jQuery("#popup_display_animation_type").val()&&jQuery(".animation-speed, .animation-origin").show()},n=function(){var e=jQuery("#popup_display_location"),t=e.parents("table"),o=e.val();jQuery("tr.top, tr.right, tr.left, tr.bottom",t).hide(),o.indexOf("top")>=0&&jQuery("tr.top").show(),o.indexOf("left")>=0&&jQuery("tr.left").show(),o.indexOf("bottom")>=0&&jQuery("tr.bottom").show(),o.indexOf("right")>=0&&jQuery("tr.right").show()},r=function(){jQuery("#popup_auto_open_session_cookie").is(":checked")?jQuery(".not-session-cookie").hide():jQuery(".not-session-cookie").show()},a=function(){jQuery("#popup_auto_open_enabled").is(":checked")?(jQuery(".auto-open-enabled").show(),r()):jQuery(".auto-open-enabled").hide()},s=function(){jQuery("#popup_auto_open_cookie_key").val((new Date).getTime().toString(16))},p=function(){""!==jQuery("#popuptitle").val()?jQuery("#popmake-preview .popmake-title").show().html(jQuery("#popuptitle").val()):jQuery("#popmake-preview .popmake-title").hide()},l=function(){var e="";e=jQuery("#wp-content-wrap").hasClass("tmce-active")?tinyMCE.activeEditor.getContent():jQuery("#content").val(),jQuery.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"popmake_popup_preview_content",popmake_nonce:popmake_admin_ajax_nonce,popup_id:jQuery("#post_ID").val(),popup_content:e}}).done(function(e){e.success&&(jQuery("#popmake-preview .popmake-content").html(e.content),jQuery("#popmake-preview").popmake("open"))})},c=function(){var e,t=jQuery("[name^='popup_display_']").serializeArray(),o=jQuery("#popmake-preview"),i=o.data("popmake");for(e=0;t.length>e;e+=1)0===t[e].name.indexOf("popup_display_")&&(i.meta.display[t[e].name.replace("popup_display_","")]=t[e].value);o.removeClass("theme-"+i.theme_id),i.theme_id=jQuery("#popup_theme").val(),jQuery("#popmake-preview").addClass("theme-"+i.theme_id).data("popmake",i)};jQuery("#popuptitlediv").insertAfter("#titlediv"),jQuery('[name^="menu-item"]').removeAttr("name"),jQuery("#trigger-popmake-preview").on("click",function(e){return e.preventDefault(),e.stopPropagation(),p(),c(),l(),!1}),jQuery(document).on("keydown","#popuptitle",function(e){var t=e.keyCode||e.which;9===t&&(e.preventDefault(),jQuery("#title").focus())}).on("keydown","#title, #popuptitle",function(e){var t,o=e.keyCode||e.which;e.shiftKey||9!==o||(e.preventDefault(),t="title"===jQuery(this).attr("id")?"#popuptitle":"#insert-media-button",jQuery(t).focus())}).on("keydown","#popuptitle, #insert-media-button",function(e){var t,o=e.keyCode||e.which;e.shiftKey&&9===o&&(e.preventDefault(),t="popuptitle"===jQuery(this).attr("id")?"#title":"#popuptitle",jQuery(t).focus())}).on("submit","#post",function(e){var t=jQuery("#title").val();(0===t.length||0===t.replace(/\s/g,"").length)&&(e.preventDefault(),jQuery("div#notice").remove(),jQuery("<div id='notice' class='error below-h2'><p>A name is required for all popups.</p></div>").insertAfter("h2"),jQuery("#title").focus(),jQuery("#publishing-action .spinner").removeClass("is-active"),jQuery("#publish").removeClass("disabled"),jQuery("#title").prop("required","required"))}).on("click","#popup_display_custom_height_auto",function(){o()}).on("click","#popup_auto_open_session_cookie",function(){r()}).on("click","#popup_auto_open_enabled",function(){a()}).on("click",".popmake-reset-auto-open-cookie-key",function(){s()}).on("change","#popup_display_size",function(){"custom"!==jQuery("#popup_display_size").val()&&"auto"!==jQuery("#popup_display_size").val()&&jQuery("#popup_display_position_fixed, #popup_display_scrollable_content").prop("checked",!1),o()}).on("change","#popup_display_animation_type",function(){i()}).on("change","#popup_display_location",function(){n()}),jQuery('#popmake_popup_targeting_condition_fields .targeting_condition > input[type="checkbox"]').on("click",function(){e(jQuery(this))}).each(function(){e(jQuery(this))}),jQuery('input[type="radio"][id*="popup_targeting_condition_"]').on("click",function(){t(jQuery(this))}).each(function(){t(jQuery(this))}),jQuery(".posttypediv, .taxonomydiv").each(function(){var e=jQuery(this),t=jQuery("> ul li"),o=jQuery(".tabs-panel",e);t.removeClass("tabs"),t.eq(0).addClass("tabs"),o.removeClass("tabs-panel-active").addClass("tabs-panel-inactive").removeAttr("style"),o.eq(0).removeClass("tabs-panel-inactive").addClass("tabs-panel-active")}),o(),i(),n(),a(),""===jQuery("#popup_auto_open_cookie_key").val()&&s()},theme_page_listeners:function(){var e=this;jQuery(document).on("change","select.font-family",function(){jQuery("select.font-weight option, select.font-style option",jQuery(this).parents("table")).prop("selected",!1),e.update_font_selectboxes()}).on("change","select.font-weight, select.font-style",function(){e.update_font_selectboxes()}).on("change input focusout","select, input",function(){e.update_theme()}).on("change","select.border-style",function(){var e=jQuery(this);"none"===e.val()?e.parents("table").find(".border-options").hide():e.parents("table").find(".border-options").show()}).on("change","#popup_theme_close_location",function(){var e=jQuery(this),t=e.parents("table");jQuery("tr.topleft, tr.topright, tr.bottomleft, tr.bottomright",t).hide(),jQuery("tr."+e.val(),t).show()})},update_theme:function(){var e,t=jQuery("[name^='popup_theme_']").serializeArray(),o={};for(e=0;t.length>e;e+=1)0===t[e].name.indexOf("popup_theme_")&&(o[t[e].name.replace("popup_theme_","")]=t[e].value);this.retheme_popup(o)},theme_preview_scroll:function(){var e=jQuery("#popmake-theme-editor .empreview, body.post-type-popup_theme form#post #popmake_popup_theme_preview"),t=e.parent(),o=e.offset().top-50;jQuery(window).on("scroll",function(){jQuery("> .postbox:visible",t).index(e)===jQuery("> .postbox:visible",t).length-1&&jQuery(window).scrollTop()>=o?e.css({left:e.offset().left,width:e.width(),height:e.height(),position:"fixed",top:50}):e.removeAttr("style")})},update_font_selectboxes:function(){return jQuery("select.font-family").each(function(){var e,t,o=jQuery(this),i=o.parents("table").find("select.font-weight"),n=o.parents("table").find("select.font-style"),r=i.find("option"),a=n.find("option");if(void 0!==popmake_google_fonts[o.val()]){if(e=popmake_google_fonts[o.val()],r.hide(),a.hide(),e.variants.length)for(t=0;e.variants.length>t;t+=1)"regular"===e.variants[t]?(jQuery('option[value=""]',i).show(),jQuery('option[value=""]',n).show()):(e.variants[t].indexOf("italic")>=0&&jQuery('option[value="italic"]',n).show(),jQuery('option[value="'+parseInt(e.variants[t],10)+'"]',i).show())}else r.show(),a.show();i.parents("tr:first").show(),i.find("option:visible").length<=1?i.parents("tr:first").hide():i.parents("tr:first").show(),n.parents("tr:first").show(),n.find("option:visible").length<=1?n.parents("tr:first").hide():n.parents("tr:first").show()})},convert_theme_for_preview:function(e){},initialize_theme_page:function(){jQuery("#popuptitlediv").insertAfter("#titlediv");var e=this,t=jQuery("#popup_theme_close_location").parents("table");switch(e.update_theme(),e.theme_page_listeners(),e.theme_preview_scroll(),e.update_font_selectboxes(),jQuery(document).on("click",".popmake-preview",function(e){e.preventDefault(),jQuery("#popmake-preview, #popmake-overlay").css({visibility:"visible"}).show()}).on("click",".popmake-close",function(){jQuery("#popmake-preview, #popmake-overlay").hide()}),jQuery("select.border-style").each(function(){var e=jQuery(this);"none"===e.val()?e.parents("table").find(".border-options").hide():e.parents("table").find(".border-options").show()}),jQuery(".color-picker.background-color").each(function(){var e=jQuery(this);""===e.val()?e.parents("table").find(".background-opacity").hide():e.parents("table").find(".background-opacity").show()}),jQuery("tr.topleft, tr.topright, tr.bottomleft, tr.bottomright",t).hide(),jQuery("#popup_theme_close_location").val()){case"topleft":jQuery("tr.topleft",t).show();break;case"topright":jQuery("tr.topright",t).show();break;case"bottomleft":jQuery("tr.bottomleft",t).show();break;case"bottomright":jQuery("tr.bottomright",t).show()}},retheme_popup:function(e){var t,o=jQuery(".empreview .example-popup-overlay, #popmake-overlay"),i=jQuery(".empreview .example-popup, #popmake-preview"),n=jQuery(".title, .popmake-title",i),r=jQuery(".content, .popmake-content",i),a=jQuery(".close-popup, .popmake-close",i),s="yes"===e.container_boxshadow_inset?"inset ":"",p="yes"===e.close_boxshadow_inset?"inset ":"";switch(this.convert_theme_for_preview(e),void 0!==popmake_google_fonts[e.title_font_family]&&(t="//fonts.googleapis.com/css?family="+e.title_font_family,"normal"!==e.title_font_weight&&(t+=":"+e.title_font_weight),"italic"===e.title_font_style&&(-1===t.indexOf(":")&&(t+=":"),t+="italic"),jQuery("body").append('<link href="'+t+'" rel="stylesheet" type="text/css">')),void 0!==popmake_google_fonts[e.content_font_family]&&(t="//fonts.googleapis.com/css?family="+e.content_font_family,"normal"!==e.content_font_weight&&(t+=":"+e.content_font_weight),"italic"===e.content_font_style&&(-1===t.indexOf(":")&&(t+=":"),t+="italic"),jQuery("body").append('<link href="'+t+'" rel="stylesheet" type="text/css">')),void 0!==popmake_google_fonts[e.close_font_family]&&(t="//fonts.googleapis.com/css?family="+e.close_font_family,"normal"!==e.close_font_weight&&(t+=":"+e.close_font_weight),"italic"===e.close_font_style&&(-1===t.indexOf(":")&&(t+=":"),t+="italic"),jQuery("body").append('<link href="'+t+'" rel="stylesheet" type="text/css">')),o.removeAttr("style").css({backgroundColor:PUMUtils.convert_hex(e.overlay_background_color,e.overlay_background_opacity)}),i.removeAttr("style").css({padding:e.container_padding+"px",backgroundColor:PUMUtils.convert_hex(e.container_background_color,e.container_background_opacity),borderStyle:e.container_border_style,borderColor:e.container_border_color,borderWidth:e.container_border_width+"px",borderRadius:e.container_border_radius+"px",boxShadow:s+e.container_boxshadow_horizontal+"px "+e.container_boxshadow_vertical+"px "+e.container_boxshadow_blur+"px "+e.container_boxshadow_spread+"px "+PUMUtils.convert_hex(e.container_boxshadow_color,e.container_boxshadow_opacity)}),n.removeAttr("style").css({color:e.title_font_color,lineHeight:e.title_line_height+"px",fontSize:e.title_font_size+"px",fontFamily:e.title_font_family,fontStyle:e.title_font_style,fontWeight:e.title_font_weight,textAlign:e.title_text_align,textShadow:e.title_textshadow_horizontal+"px "+e.title_textshadow_vertical+"px "+e.title_textshadow_blur+"px "+PUMUtils.convert_hex(e.title_textshadow_color,e.title_textshadow_opacity)}),r.removeAttr("style").css({color:e.content_font_color,fontFamily:e.content_font_family,fontStyle:e.content_font_style,fontWeight:e.content_font_weight}),a.html(e.close_text).removeAttr("style").css({padding:e.close_padding+"px",height:e.close_height>0?e.close_height+"px":"auto",width:e.close_width>0?e.close_width+"px":"auto",backgroundColor:PUMUtils.convert_hex(e.close_background_color,e.close_background_opacity),color:e.close_font_color,lineHeight:e.close_line_height+"px",fontSize:e.close_font_size+"px",fontFamily:e.close_font_family,fontWeight:e.close_font_weight,fontStyle:e.close_font_style,borderStyle:e.close_border_style,borderColor:e.close_border_color,borderWidth:e.close_border_width+"px",borderRadius:e.close_border_radius+"px",boxShadow:p+e.close_boxshadow_horizontal+"px "+e.close_boxshadow_vertical+"px "+e.close_boxshadow_blur+"px "+e.close_boxshadow_spread+"px "+PUMUtils.convert_hex(e.close_boxshadow_color,e.close_boxshadow_opacity),textShadow:e.close_textshadow_horizontal+"px "+e.close_textshadow_vertical+"px "+e.close_textshadow_blur+"px "+PUMUtils.convert_hex(e.close_textshadow_color,e.close_textshadow_opacity)}),e.close_location){case"topleft":a.css({top:e.close_position_top+"px",left:e.close_position_left+"px"});break;case"topright":a.css({top:e.close_position_top+"px",right:e.close_position_right+"px"});break;case"bottomleft":a.css({bottom:e.close_position_bottom+"px",left:e.close_position_left+"px"});break;case"bottomright":a.css({bottom:e.close_position_bottom+"px",right:e.close_position_right+"px"})}jQuery(document).trigger("popmake-admin-retheme",[e])}},t.ready(function(){PopMakeAdmin.init(),t.trigger("pum_init")})}(jQuery);